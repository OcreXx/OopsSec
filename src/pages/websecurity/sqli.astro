---
import BaseLayout from "../../layouts/BaseLayout.astro";
---
<BaseLayout title="SQL Injection - Web Security">
  <div class="websec-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
      <a href="/websecurity/">Web Security</a>
      <span class="separator">â†’</span>
      <span class="current">SQL Injection</span>
    </div>

    <!-- Hero Section -->
    <section class="detail-hero">
      <div class="hero-badge critical">
        <span class="badge-icon">ğŸ”´</span>
        OWASP Top 3
      </div>
      <h1 class="detail-title">
        <span class="title-icon">ğŸ’‰</span>
        SQL Injection
      </h1>
      <p class="detail-description">
        Aprende a identificar, explotar y prevenir vulnerabilidades de SQL Injection. 
        Desde conceptos bÃ¡sicos hasta tÃ©cnicas avanzadas como UNION-based y Blind SQL Injection.
      </p>
    </section>

    <!-- Quick Stats -->
    <div class="quick-stats">
      <div class="stat-card">
        <span class="stat-icon">ğŸ“Š</span>
        <div>
          <div class="stat-value">Severity</div>
          <div class="stat-label">Critical</div>
        </div>
      </div>
      <div class="stat-card">
        <span class="stat-icon">ğŸ§ª</span>
        <div>
          <div class="stat-value">7 Labs</div>
          <div class="stat-label">PortSwigger</div>
        </div>
      </div>
      <div class="stat-card">
        <span class="stat-icon">â±ï¸</span>
        <div>
          <div class="stat-value">~4 horas</div>
          <div class="stat-label">Tiempo estimado</div>
        </div>
      </div>
      <div class="stat-card">
        <span class="stat-icon">ğŸ“ˆ</span>
        <div>
          <div class="stat-value">Medio</div>
          <div class="stat-label">Dificultad</div>
        </div>
      </div>
    </div>

    <!-- Content Section -->
    <div class="content-section">
      <!-- Introduction -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ“–</span>
          Â¿QuÃ© es SQL Injection?
        </h2>
        <p>
          SQL Injection (SQLi) es una vulnerabilidad crÃ­tica que ocurre cuando una aplicaciÃ³n construye 
          consultas SQL dinÃ¡micas con entrada del usuario sin validarla o parametrizarla correctamente. 
          Esto permite al atacante inyectar cÃ³digo SQL malicioso para:
        </p>
        <ul class="feature-list">
          <li><span class="list-icon">ğŸ”“</span> Bypasear autenticaciÃ³n</li>
          <li><span class="list-icon">ğŸ“Š</span> Extraer datos sensibles de la base de datos</li>
          <li><span class="list-icon">âœï¸</span> Modificar o eliminar registros</li>
          <li><span class="list-icon">âš™ï¸</span> Ejecutar comandos del sistema operativo (en casos avanzados)</li>
        </ul>
      </div>

      <!-- Types -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ¯</span>
          Tipos de SQL Injection
        </h2>
        
        <div class="type-grid">
          <div class="type-card">
            <div class="type-header">
              <span class="type-icon">ğŸ“¤</span>
              <h3>In-Band SQLi</h3>
            </div>
            <p>Los datos se extraen usando el mismo canal de comunicaciÃ³n. Es el tipo mÃ¡s comÃºn y fÃ¡cil de explotar.</p>
            <div class="type-subtypes">
              <span class="subtype-tag">Error-based</span>
              <span class="subtype-tag">UNION-based</span>
            </div>
          </div>

          <div class="type-card">
            <div class="type-header">
              <span class="type-icon">ğŸ‘ï¸</span>
              <h3>Blind SQLi</h3>
            </div>
            <p>La aplicaciÃ³n no muestra errores ni datos directamente. Se usa inferencia mediante respuestas booleanas o tiempos.</p>
            <div class="type-subtypes">
              <span class="subtype-tag">Boolean-based</span>
              <span class="subtype-tag">Time-based</span>
            </div>
          </div>

          <div class="type-card">
            <div class="type-header">
              <span class="type-icon">ğŸŒ</span>
              <h3>Out-of-Band SQLi</h3>
            </div>
            <p>Usa canales externos (DNS, HTTP callbacks) para extraer datos cuando otros mÃ©todos no funcionan.</p>
            <div class="type-subtypes">
              <span class="subtype-tag">DNS exfiltration</span>
              <span class="subtype-tag">HTTP requests</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Example -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ’»</span>
          Ejemplo Vulnerable
        </h2>
        <div class="code-example">
          <div class="code-header">
            <span class="code-lang">Python</span>
            <span class="code-label">âŒ CÃ³digo Vulnerable</span>
          </div>
          <pre><code>query = "SELECT * FROM users WHERE username = '" + user_input + "'"
cursor.execute(query)</code></pre>
        </div>
        
        <div class="attack-example">
          <h4>Ataque de ejemplo:</h4>
          <div class="code-example">
            <div class="code-header">
              <span class="code-lang">Payload</span>
            </div>
            <pre><code>admin' OR '1'='1' --</code></pre>
          </div>
          <p class="attack-result">
            <span class="result-icon">âš ï¸</span>
            Resultado: La consulta se convierte en <code>SELECT * FROM users WHERE username = 'admin' OR '1'='1' --'</code>
            retornando todos los usuarios.
          </p>
        </div>
      </div>

      <!-- Labs Section -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ§ª</span>
          Laboratorios PrÃ¡cticos
        </h2>
        
        <div class="labs-grid">
          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB01/Lab1.html" class="lab-card">
            <div class="lab-number">Lab 01</div>
            <h3>SQL Injection BÃ¡sico</h3>
            <p>Aprende las bases de SQL Injection con un login vulnerable</p>
            <div class="lab-meta">
              <span class="lab-difficulty easy">FÃ¡cil</span>
              <span class="lab-time">â±ï¸ 15 min</span>
            </div>
          </a>

          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB02/Lab2.html" class="lab-card">
            <div class="lab-number">Lab 02</div>
            <h3>UNION Attack</h3>
            <p>Explota SQLi usando UNION para extraer datos</p>
            <div class="lab-meta">
              <span class="lab-difficulty medium">Medio</span>
              <span class="lab-time">â±ï¸ 30 min</span>
            </div>
          </a>

          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB03/sqli03.TXT" class="lab-card">
            <div class="lab-number">Lab 03</div>
            <h3>Blind SQL Injection</h3>
            <p>TÃ©cnicas de inferencia con respuestas booleanas</p>
            <div class="lab-meta">
              <span class="lab-difficulty medium">Medio</span>
              <span class="lab-time">â±ï¸ 45 min</span>
            </div>
          </a>

          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB04/SQLI04.txt" class="lab-card">
            <div class="lab-number">Lab 04</div>
            <h3>Time-based Blind SQLi</h3>
            <p>Usa retardos para inferir informaciÃ³n</p>
            <div class="lab-meta">
              <span class="lab-difficulty hard">DifÃ­cil</span>
              <span class="lab-time">â±ï¸ 60 min</span>
            </div>
          </a>

          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB05/sqli05.txt" class="lab-card">
            <div class="lab-number">Lab 05</div>
            <h3>Second-Order SQL Injection</h3>
            <p>SQLi que se ejecuta en un contexto diferente</p>
            <div class="lab-meta">
              <span class="lab-difficulty hard">DifÃ­cil</span>
              <span class="lab-time">â±ï¸ 50 min</span>
            </div>
          </a>

          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB06/sqli06.txt" class="lab-card">
            <div class="lab-number">Lab 06</div>
            <h3>UNION con mÃºltiples columnas</h3>
            <p>TÃ©cnicas avanzadas de UNION para extraer datos complejos</p>
            <div class="lab-meta">
              <span class="lab-difficulty hard">DifÃ­cil</span>
              <span class="lab-time">â±ï¸ 55 min</span>
            </div>
          </a>

          <a href="/WebSecurity/sqlInjection/PortSwigger/LAB07/SQLI07.TXT" class="lab-card">
            <div class="lab-number">Lab 07</div>
            <h3>Filter Bypass Avanzado</h3>
            <p>EvasiÃ³n de filtros WAF y tÃ©cnicas de obfuscaciÃ³n</p>
            <div class="lab-meta">
              <span class="lab-difficulty hard">DifÃ­cil</span>
              <span class="lab-time">â±ï¸ 70 min</span>
            </div>
          </a>
        </div>
      </div>

      <!-- Prevention -->
      <div class="content-card prevention-card">
        <h2>
          <span class="section-icon">ğŸ›¡ï¸</span>
          PrevenciÃ³n y MitigaciÃ³n
        </h2>
        <div class="prevention-grid">
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>Prepared Statements</h4>
              <p>Usa consultas parametrizadas - la mejor defensa contra SQLi</p>
            </div>
          </div>
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>Input Validation</h4>
              <p>Valida y sanitiza toda entrada del usuario</p>
            </div>
          </div>
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>Least Privilege</h4>
              <p>Limita los permisos de la cuenta de base de datos</p>
            </div>
          </div>
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>WAF & Monitoring</h4>
              <p>Implementa un WAF y monitorea consultas sospechosas</p>
            </div>
          </div>
        </div>
      </div>

      <!-- Resources -->
      <div class="content-card resources-mini">
        <h2>
          <span class="section-icon">ğŸ“š</span>
          Recursos Adicionales
        </h2>
        <div class="resources-links">
          <a href="/WebSecurity/sqlInjection/sqlITheory/06-CheatSheet.html" class="resource-link">
            <span class="resource-emoji">ğŸ“‹</span>
            <span>CheatSheet SQL Injection</span>
          </a>
          <a href="/WebSecurity/sqlInjection/sqlITheory/05-Prevencion.html" class="resource-link">
            <span class="resource-emoji">ğŸ›¡ï¸</span>
            <span>GuÃ­a de PrevenciÃ³n</span>
          </a>
          <a href="/WebSecurity/sqlInjection/HackTheBox/Machine1.html" class="resource-link">
            <span class="resource-emoji">ğŸ´</span>
            <span>HackTheBox Machines</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Back Button -->
    <div class="navigation-back">
      <a href="/websecurity/" class="btn-back">
        <span class="back-arrow">â†</span>
        Volver a Web Security
      </a>
    </div>
  </div>
</BaseLayout>
